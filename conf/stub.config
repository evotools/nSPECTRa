params {
    variants = "./test/file.vcf.gz"
    idx = "./test/file.vcf.gz.tbi"
    hal = './test/bovinae.hal'
    reference = 'hereford'
    target = "Anc3"
    outdir = 'results' 
    algorithm = 'mutyper,sdm,relate'
    imputation = 'shapeit4'
    species = 'bos_taurus'
    k = '3,5,7'
    neval = 10000
    filter = 'n'
    annotation = false
    pops_folder = './test/pops/'
    relate = './test/Relate'
    shapeit=false
    beagle=false
    refinedibd=false
    vep_cache='./test/vepcache'
    ibd_params= 'window=10 trim=0.015 length=0.2 lod=4'
    custom_vep=false
    gff='PATH'
    help = false
    publish_dir_mode = 'copy'
}


process {   
    cpus = 1   
    memory = '2G'   
    errorStrategy = { task.attempt <= 2 ? "retry" : "ignore" }   
    maxRetries = 2 
    maxErrors = '-1'
  
    withLabel: small{
      cpus = 1
      memory = { 2.GB * task.attempt }
      time = {4.h * task.attempt }
    }
    withLabel: medium{
      cpus = 1
      memory = { 4.GB * task.attempt }
      time = { 8.h * task.attempt }
    }
    withLabel: medium_mem{
      cpus = 1
      memory = { 12.GB * task.attempt }
      time = { 12.h * task.attempt }
      clusterOptions = { "-P roslin_ctlgh -l h_vmem=${task.memory.toString().replaceAll(/[\sB]/,'')}" }
    }
    withLabel: medium_multi{
      cpus = 2
      memory = { 4.GB * task.attempt }
      time = { 12.h * task.attempt }
    }
    withLabel: large{
      cpus = 2
      memory = { 1.GB * task.attempt }
      time = { 1.h * task.attempt }
    }
    withLabel: large_smallmem{
      cpus = 8
      memory = { 1.GB * task.attempt }
      time = { 1.h * task.attempt }
    }
    withLabel: large_largemem{
      cpus = 8
      memory = { 1.GB * task.attempt }
      time = { 1.h * task.attempt }
    }
    withLabel: largemem{
      cpus = 1
      memory = { 12.GB * task.attempt }
      time = { 96.h * task.attempt }
    }
    withLabel: compile{
      cpus = 4
      memory = { 4.GB * task.attempt }
      time = {4.h * task.attempt }
    }
    withLabel: vep{
      cpus = 4
      memory = { 4.GB * task.attempt }
      time = { 12.h * task.attempt }
    }
    withLabel: renv{
      cpus = 1
      memory = { 4.GB * task.attempt }
      time = { 23.h * task.attempt }
    }
    withLabel: renv_large{
      cpus = 1
      memory = { 4.GB * task.attempt }
      time = { 23.h * task.attempt }
    }
    withName: sdm{
      cpus = 1
      memory = { 1.GB * task.attempt }
      time = {1.h * task.attempt }
    }
}
